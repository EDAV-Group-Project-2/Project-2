---
title: "ggsmock2_final.rmd"
author: "ian johnson"
date: "March 7, 2016"
output: html_document
---

```{r setup, include=FALSE}
# Put your libs here:
library(ncdf4)
library(RNetCDF)
library(ggplot2)
library(ggbiplot)
library(lattice)
library(rworldmap)

setwd('~/Desktop/Columbia/EDAV/Project2')

# Import the two datasets
ncin <- nc_open("NOAA_Daily_phi_500mb.nc")
flood_df = read.csv('GlobalFloodsRecord.csv', fileEncoding="macroman", stringsAsFactors = FALSE)
```


## Introduction
In this report, we summarize data from two datasets, one on geopotential height values in the northern hemisphere global region ranging from 35 degrees N to 70 degrees N, with a time dimensions ranging from 1944 to the present, and the other with details of flooding events from the time period ranging from 1985 to 2016. We present this data using visual representations that show the overall trends, and we gain insights into the trends and relationships between the following variables:

- average geopotential height values across this time period
- number of flooding events per year
- average area affected by events
- variation in amount of flooding between years
- financial damage cause by these events


## Basic flood data
Here we show basic flooding statistics. The following graphs represent the number of flooding events per month for each year, and we can see that some years exhibit increased flooding in the late summer months.

```{r scatterplot, fig.width=14, fig.height=14, echo=FALSE, results="hide"}
# Format dates for parsing
df_ian = data.frame(as.Date(flood_df$Began, "%e-%b-%y"))
names(df_ian) = c("newDate")
df_ian2 = subset(df_ian, newDate >= "1985-01-01" & newDate <= "2008-01-01")

##### Trellis plot for flood counts per year
histogram(
  ~factor(
    format(df_ian2$newDate,"%b"),
    levels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
  ) | factor(
    format(df_ian2$newDate,"%y"),
    level = c("85", "86", "87", "88", "89", "90", "91", "92", "3", "94", "99", "00", "01", "02", "03", "04", "05", "06", "07", "08")
  ),
  data=df_ian2, layout=(c(3,6)),
  main="Flood Counts by year and month",
  ylab="Flood Count",
  xlab="Year"
)
```



## Conclusions
From out ANOVA analysis we conclude that there is a statisitcally sigificant difference between the value of the damaged caused by flooding in the 1990s and the 2000s. We also can see from the graphs that flood events occur around rivers and coastal regions, and when coupled with trellis plots of flooding events across months by year, there appear to be time periods of increased flooding that coorespond with months in late summer. 

